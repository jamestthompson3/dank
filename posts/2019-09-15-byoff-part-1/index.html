<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>✨ Basic Components</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:image" content><link rel=canonical href=https://teukka.tech/posts/2019-09-15-byoff-part-1/><meta property="og:title" content="Build Your Own Frontend Framework Part 1"><meta property="og:description" content="Setting up basic components in our framework"><meta property="og:type" content="article"><meta property="og:url" content="https://teukka.tech/posts/2019-09-15-byoff-part-1/"><meta property="og:image" content="https://images.unsplash.com/photo-1501686637-b7aa9c48a882?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=675&q=80"><meta property="article:published_time" content="2019-09-15T00:00:00+00:00"><meta property="article:modified_time" content="2019-09-15T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1501686637-b7aa9c48a882?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=675&q=80"><meta name=twitter:title content="Build Your Own Frontend Framework Part 1"><meta name=twitter:description content="Setting up basic components in our framework"><link href=https://teukka.techcss/fonts.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://teukka.techcss/main.css><link rel=stylesheet type=text/css href=https://teukka.techcss/dark.css media="(prefers-color-scheme: dark)"><script>if(window.location.host!=='teukka.tech')
window.goatcounter={no_onload:true};</script></head><body><div class=content><header><div class=main><a href=https://teukka.tech>Taylor Thompson's Blog</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/knowledgebase>Knowledge Base</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Build Your Own Frontend Framework Part 1</h1><div class=meta>Posted on Sep 15, 2019</div></div><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/webdev>webdev</a></li><li><a href=/tags/javascript>javascript</a></li><li><a href=/tags/learning>learning</a></li></ul></nav></div><section class=body><h2 id=part-one-basic-component>Part One, Basic Component</h2><p>Components will be the basic building blocks of our frontend framework. Components will allow modular composition and encapsulation.
The first component implementation will be rather naive, but that&rsquo;s alright since its implementation will evolve over time.
Let&rsquo;s start with creating a <code>Component</code> class:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:red>const</span> COOL_COMPONENT = Symbol(<span style=color:#87ceeb>&#34;component&#34;</span>);

<span style=color:red>class</span> Component {
  constructor(element, args = {}) {
    <span style=color:red>this</span>.$$typeof = COOL_COMPONENT;
    <span style=color:red>this</span>.el = document.createElement(element);
    <span style=color:red>this</span>.args = args;
  }
}
</code></pre></div><p>Breaking this down:</p><p><code>const COOL_COMPONENT = Symbol('component')</code></p><p>This creates a unique representation for our component type, and will help identify component instances as they get passed around our framework.
The component takes an element type and some arguments which we&rsquo;ll handle a bit later. The constructor also creates a new element which we&rsquo;ll mount on the DOM with a <code>mount</code> function.
Now that we have a very basic component, we need a way to mount it to the DOM. Starting with a naive implementation, we can do something like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:red>function</span> renderToDOM(id, component) {
  <span style=color:red>const</span> root = document.querySelector(<span style=color:#87ceeb>`#</span><span style=color:#87ceeb>${</span>id<span style=color:#87ceeb>}</span><span style=color:#87ceeb>`</span>);
  root.appendChild(Component.el);
}
</code></pre></div><p>With this code, we can create components and mount them to the DOM. Let&rsquo;s start building!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;div id=<span style=color:#87ceeb>&#34;root&#34;</span>&gt;&lt;/div&gt;
&lt;script&gt;
  <span style=color:red>const</span> div = <span style=color:red>new</span> Component(<span style=color:#87ceeb>&#34;div&#34;</span>);
  renderToDOM(<span style=color:#87ceeb>&#34;root&#34;</span>, div);
&lt;/script&gt;
</code></pre></div><p>This is quite boring, so let&rsquo;s add the ability to style our components and render sub components, or <code>children</code>.
To do this, we will add a couple more methods to our <code>Component</code> class. We&rsquo;ll start with the <code>mount</code> method:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#0f0>// inside Component class
</span><span style=color:#0f0></span>mount() {
  Object.entries(<span style=color:red>this</span>.args.style).forEach(([styleKey, styleValue]) =&gt; {
    <span style=color:red>this</span>.el.style[styleKey] = styleValue
  })
}
</code></pre></div><p>In the <code>mount</code> method, we take a style object passed to the component in <code>args</code> and append the component&rsquo;s element with the given style property.
While this currently doesn&rsquo;t allow us to style components with css selectors, it does allow for simple inline styling that will help us troubleshoot components.
For our component to render children, we need to add a <code>render</code> method which will take children components as an argument and correctly render them out to the DOM.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#0f0>// inside of Component class
</span><span style=color:#0f0></span>render(children) {
  <span style=color:red>if</span> (!Array.isArray(children)) {
    <span style=color:red>throw</span> <span style=color:red>new</span> Error(<span style=color:#87ceeb>&#39;Children must be an array!&#39;</span>)
  }
  <span style=color:red>const</span> components = []
  children.forEach(child =&gt; {
    <span style=color:red>if</span> (child.$$typeof === COOL_COMPONENT) {
      components.push(child.el)
    }
    <span style=color:red>if</span> (<span style=color:red>typeof</span> child === <span style=color:#87ceeb>&#39;string&#39;</span>) {
      <span style=color:red>this</span>.el.appendChild(document.createTextNode(child))
    }

    <span style=color:red>this</span>.el.append(...components)

    <span style=color:red>return</span> <span style=color:red>this</span>
  })
}
</code></pre></div><p>When given an array of children, <code>render</code> iterates through the array and checks if the child is a component. If it is, then it adds it to another array of components to be appended, if the child is a string, it is appended as a text node to the current component.</p><p>Putting all these pieces together looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:red>const</span> COOL_COMPONENT = Symbol(<span style=color:#87ceeb>&#34;component&#34;</span>);

<span style=color:red>class</span> Component {
  constructor(element, args = {}) {
    <span style=color:red>this</span>.$$typeof = COOL_COMPONENT;
    <span style=color:red>this</span>.el = document.createElement(element);
    <span style=color:red>this</span>.args = args;
  }
  mount() {
    Object.entries(<span style=color:red>this</span>.args.style).forEach(([styleKey, styleValue]) =&gt; {
      <span style=color:red>this</span>.el.style[styleKey] = styleValue;
    });
  }

  render(children) {
    <span style=color:red>if</span> (!Array.isArray(children)) {
      <span style=color:red>throw</span> <span style=color:red>new</span> Error(<span style=color:#87ceeb>&#34;Children must be an array!&#34;</span>);
    }
    <span style=color:red>const</span> components = [];
    children.forEach((child) =&gt; {
      <span style=color:red>if</span> (child.$$typeof === COOL_COMPONENT) {
        components.push(child.el);
      }
      <span style=color:red>if</span> (<span style=color:red>typeof</span> child === <span style=color:#87ceeb>&#34;string&#34;</span>) {
        <span style=color:red>this</span>.el.appendChild(document.createTextNode(child));
      }

      <span style=color:red>this</span>.el.append(...components);

      <span style=color:red>return</span> <span style=color:red>this</span>;
    });
  }
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#0f0>&lt;!--- index.html ----&gt;</span>
&lt;div id=<span style=color:#87ceeb>&#34;root&#34;</span>&gt;&lt;/div&gt;
&lt;script&gt;
  <span style=color:red>const</span> div = <span style=color:red>new</span> Component(<span style=color:#87ceeb>&#34;div&#34;</span>, {
    style: { height: <span style=color:#87ceeb>&#34;300px&#34;</span>, width: <span style=color:#87ceeb>&#34;300px&#34;</span>, background: <span style=color:#87ceeb>&#34;papayawhip&#34;</span> },
  });

  <span style=color:red>const</span> title = <span style=color:red>new</span> Component(<span style=color:#87ceeb>&#34;h1&#34;</span>);

  div.render([title.render([<span style=color:#87ceeb>&#34;This is a title&#34;</span>])]);

  renderToDOM(<span style=color:#87ceeb>&#34;root&#34;</span>, div);
&lt;/script&gt;
</code></pre></div><p>One last thing to do for our basic component is to add event listeners. We can do this in the <code>mount</code> method of our comonent:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>
mount() {
  Object.entries(<span style=color:red>this</span>.args.style).forEach(([styleKey, styleValue]) =&gt; {
    <span style=color:red>this</span>.el.style[styleKey] = styleValue
  })
  <span style=color:red>if</span> (<span style=color:red>this</span>.args.on) {
    <span style=color:red>this</span>.args.on.forEach(handler =&gt; {
      <span style=color:red>const</span> [event, func] = Object.entries(handler)[<span style=color:#f60>0</span>]
      <span style=color:red>this</span>.el.addEventListener(event, func)
    })
  }
}
</code></pre></div><p>Now we can pass an array of events and their respective handler functions to our component with the <code>on</code> argument.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:red>const</span> div = <span style=color:red>new</span> Component(<span style=color:#87ceeb>&#34;div&#34;</span>, {
  style: { height: <span style=color:#87ceeb>&#34;300px&#34;</span>, width: <span style=color:#87ceeb>&#34;300px&#34;</span>, background: <span style=color:#87ceeb>&#34;papayawhip&#34;</span> },
  on: [{ click: () =&gt; console.log(<span style=color:#87ceeb>&#34;Hello there&#34;</span>) }],
});
</code></pre></div><p>With that, we have a basic component that can be styled and have event listeners attached to it. Next time we&rsquo;ll continue iterating on this component to improve the api and extending it to handle things like class names and asynchronous actions.</p></section></article></main><h3>See Also</h3><ul><li><a href=/posts/2019-09-09-build-your-own-frontend-framework/>Build Your Own Frontend Framework, Introduction</a></li><li><a href=/knowledgebase/>Knowledge Base</a></li></ul><footer><hr>⚡️
2021 modified <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></footer></div></body></html>